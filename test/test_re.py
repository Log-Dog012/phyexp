import re

num_pattern = re.compile(
    # 整体结构：(可选括号包裹) + 核心内容 + (可选科学计数法后缀)
    r'(?:\(\s*)?'  # 可选左括号（带空格）
    # 核心内容：数值 [不确定度]
    r'((?:0|[1-9]\d*)(?:\.\d+)?(?:[eE][-+]?\d+)?|nan)'  # 主数值（含纯nan）
    r'(?:'  # 不确定度（可选）
        r'(?:\s*[+-]/[+-]|[\s±]+)\s*'  # +/- 或 ±（合并空格处理）
        r'[-+]?(?:0|[1-9]\d*)(?:\.\d+)?(?:[eE][-+]?\d+)?'  # 不确定度数值
        r'|'
        r'\(\s*(?:[-+]?(?:0|[1-9]\d*)(?:\.\d+)?(?:[eE][-+]?\d+)?|nan)\s*\)'  # 括号形式
    r')?'
    r'(?:\s*\))?'  # 可选右括号（带空格）
    r'(?:[eE][-+]?\d+)?'  # 科学计数法后缀
)

test_cases = [
    "12.58+/-0.23",    # +/- 形式
    "12.58 ± 0.23",    # ± 形式
    "3.85e5 +/- 2.3e4",# 科学计数法+/-
    "(38.5 +/- 2.3)e4",# 括号整体+科学计数法
    "72.1(2.2)",       # 括号内带小数点
    "72.15(4)",        # 括号内整数（末位量级）
    "680(41)e-3",      # 括号+科学计数法后缀
    "23.2",            # 无不确定度（默认末位±1）
    "23.29",           # 无不确定度（默认末位±0.01）
    "nan",             # nan（默认不确定度1.0）
    "680.3(nan)",      # 数值+nan不确定度
    "-123.45(6)",      # 带负号
]

for case in test_cases:
    match = num_pattern.findall(case)
    print(f"匹配 '{case}': {'成功' if match else '失败'}")